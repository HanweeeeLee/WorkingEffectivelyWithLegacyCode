# 17. 내 애플리케이션은 뼈대가 약하다

오래된 애플리케이션은 무질서하게 확장되기 쉽다.  
개발 팀이 아키텍처를 이해하고 있지 않다면 아키텍처는 계속 퇴보한다. 아키텍처 이해를 가로막는 요인에는 어떤 것들이 있을까?
 - 시스템이 너무 복잡해서 전체 그림을 이해하는 데 오랜 시간이 걸린다. 
 - 시스템이 너무 복잡해서 전체 그림이 아예 없다.
 - 전체 그림이 없다보니 긴급 상황이 끊임없이 발생한다. 그리고 이를 처리하느날 땜질 처방에 급급하게 된다.
  
전통적으로 많은 조직들은 이런 문제를 풀기 위해 아키텍트라는 역할을 뒀다.  
아키텍트는 개발 팀에 차염해 매일 함께 일해야 한다. 그렇지 않으면 코드는 전체 그림을 벗어나게 됨.  
그렇게 되는 이유는 
 1. 누군가가 코드에 부적절한 작업을 한 경우
 2. 전체 그림 자체를 수정해야 할 필요가 생긴 경우
  
아키텍처는 몇몇 사람에게만 맡겨지기에는 너무나 중요.  
모르는 사람이 실수할 수 있음...  
그럼 어떻게 해야 대규모 시스템의 전체 그림을 알 수 있을까?  

## 시스템의 스토리텔링
이 기법을 위해서는 최소한 두 사람이 필요함.
1. 한 사람이 다른 사람에게 다음과 같이 질문한다. "시스템의 아키텍처는 어떤가요?"
2. 그러면 상대방은 최대 2~3개만의 개념을 갖고 시스템의 아키텍처를 설명하려고 노력한다.
3. 이 설명을 끝내면, 시스템에서 가장 핵심적이라고 생각되는 것을 명확하게 설명한 것이 된다.
4. 그러고는 시스템에서 그 다음으로 중요하다고 생각되는 것을 주제로 대화한다.
5. 이런 과정을 시스템의 핵심 설계와 관련 있는 중요 사항이 모두 나올 떄까지 반복한다.
  
이 기법이 중요한 이유 
1. 단순화 된 견해를 명로하게 표현할 수 있다. 최소한 무엇이 이상적이고 편의적인지 팀원 전체가 이해할 수 있게 된다.
2. 시스템에서 무엇이 중요한지 생각하게 만든다.

### 예시
**JUnit의 아키텍처는 어떻게 구성돼 있는가?**  
JUnit은 두 개의 주요 클래스를 가진다. 하나는 Test고, 다른 하나는 TestResult다. 사용자는 테스트 케이스를 생성한 후 이를 TestResult에게 전달함으로써 테스트를 실행할 수 있다. 테스트에 실패한 경우 그 결과를 TestResult에게 알려준다. 따라서 TestResult를 통해 실패 원인을 알 수 있다.  
  
**단순화된 스토리**  
1. JUnit에는 그 밖에도 많은 클래스가 있다. Test와 TestResult가 중요 클래스라고 말한것은 내가 그렇게 생각하기 떄문일 뿐이다. 나는 이 두 개 클래스 간의 상호작용이 시스템의 핵심 상호작용이라고 생각한다. 다른 사람은 나와는 다르지만 여전히 유효한 아키텍처에 대한 관점을 갖고 있을 수 있다.
...  
...  
...  
...  
  
**지금까지의 내용이 전부일까?**  
그렇지 않다. Test는 TestSuite라는 객체로 묶을 수 있다. 하나의 Test를 실행한 것과 똑같은 방법으로 하나의 TestSuite를 실행해서 결과를 얻을 수 있다.  
...  
...  
...  

## 네이키드 CRC
CRC는 Class 클래스, Responsibility 책임, coolaboration 협력 의 첫 글짜를 따서 만든 용어.  
카드에는 클래스의 이름, 책임, 협업클래스가 기재 된다. 카드에 기재된 책임이 해당 클래스에 속하지 않는다고 판단되면, 책임 위에 취소선을 긋고 다른 클래스 카드에 기재하거나 클래스 카드를 새로 만든다.  
요즘에는 인기 없음.. 다이어그램을 사용함.. UML  
네이키드 CRC를 쓰는건 괜찮은듯?

### 네이키드 CRC 순서
1. 시스템을 설명하는 사람은 아무것도 쓰여 있지 않은 카드를 한 장씩 테이블 위에 올려놓는다. 그러고 나서 시스템 내의 전형적인 객체가 무엇이고 객체들 간의 상호작용이 무엇인지 표현하기 위해 카드를 옮기거나 가리키거나 그 밖의 다양한 행위를 할 수 있다.  
  
온라인 투표 시스템을 예를 들어보자.
![KakaoTalk_Photo_2023-02-20-23-42-01 002](https://user-images.githubusercontent.com/60125719/220136668-348fbe4c-b6b6-4b25-a685-aae9d715c4fd.jpeg)
![KakaoTalk_Photo_2023-02-20-23-42-00 001](https://user-images.githubusercontent.com/60125719/220136751-52aebe16-1b7b-42e7-8265-bfcd6c4bb4d9.jpeg)

시스템의 다양한 부분을 명확하게 할 수 있기 때문에 유용함.  
네이키드 CRC는 단 두개의 지침만 있다.
1. 카드는 인스턴스를 나타내는 것이지 클래스를 나타내는 것이 아니다.
2. 카드를 겹처놓음으로써 카다들의 컬렉션을 나타낸다.

## 대화 음미
설계에 대한 대화에 귀를 기울이자. 대화에서 사용되는 개념이 코드 내의 개념과 동일한가? 모두가 같아야만 한다고 말하는것은 아님.  
대화와 코드가 상당 수준으로 유사하지 않다면 그 이유를 점검해야 한다. 만약 유사하지 않다면 일반적으로  
1. 개발팀이 이해하는 바가 코드에 충분히 반영되지 않았거나
2. 개발 팀이 코드를 다르게 이해할 필요가 있다.  
  
어느 경우든, 사람들이 설계를 설명할 떄 자연스럽게 사용하는 개념과 가급적 일치시키는 것이 바람직하다.  



































