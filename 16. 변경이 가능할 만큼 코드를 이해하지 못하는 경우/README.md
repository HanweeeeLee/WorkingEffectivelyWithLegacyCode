# 16. 변경이 가능할 만큼 코드를 이해하지 못하는 경우
잘 모르는 코드, 특히 레거시 코드처럼 익숙하지 않은 코드에 발을 들이는 것은 두렵게 느껴질 수 있다.  
하지만 변경 작업을 하기 위해 알아야 할 것을 모두 이해하고 있다면 일은 쉽게 풀릴 수 이쑈다. 어떻게 해야 그런 것들을 이해할 수 있을까?
코드를 이해하는 방법은 다양하지만, 대부분의 사람은 가장 직접적인 방법에만 사로잡혀서 다른 방법들은 사용하지 않는다.  
이 장에서는 간단하고 복잡하지 않은 몇가지 작업을 알려준다.  

## 노트/스케치
코드를 읽는 것만으로는 헷갈린다면, 그림을 그리거나 노트에 메모하는 것이 효과적이다.  
가장 마지막으로 봤던 중요사항의 이름을 쓰고, 그 다음으로 중요 사항의 이름을 적어나간다. 그 사이에 어떤 관계가 있다면 선을 긋는다.  
이 스케치가 완벽한 UML 다이어 그램이거나 특정 표기법을 따르는 함수 호출 그래프일 필요는 없다. 다만 그림이 복잡해 질 수록 효율적인 표현을 위해 정형화된 표기법을 사용하고 싶어질 것이다.  
시스템의 일부에 대한 스케치를 그리다 보면 좀 더 시간을 들여서 전체 그림을 이해하고 싶어진다.(대규모 코드를 이해하기 쉽도록 도와주는 기법에대해서는 17장 참고)  

## 표시 나열
이 방법은 매우 규모가 큰 메소드 일때 특히 유용하다.  
표시 나열 기법은 이해하려는 대상에 따라 달라진다. 먼저 작업 대상 코드르르 프린터로 출력하고, 다음과 같은 용도별로 표시 나열 기법을 사용할 수 있다.  
### 책임 분리
책임을 분리할 때는 대상을 그룹별로 나누기 위해 표시를 사용한다.  
몇개의 대상이 동일 그룹에 속한다면, 이것들을 식별할 수 있도록 각각에 특별한 기호를 표시한다. 가능하다면 다양한 색을 사용하라.  
### 메소드 구조의 이해
코드의 길이가 긴 대규모 메소드의 구조를 이해하고 싶을 때는 코드 블록에 선을 긋는다.  
이런 경우는 들여쓰기를 해도 여전히 읽기 힘들 때가 많은데 이런 메소드에 대해서는 코드블록의 처음부분과 끝부분에 선을 긋거나 블록의 끝부분에 그 블록이 시작된 반복문이나 분기문의 문자열을 적어두면 좋다.  
### 메소드 추출
코드의 길이가 긴 대규모 메소드를 분리하고 싶을때는 추출하려는 코드 주변을 원으로 표시하고, 결합 카운트를 주석으로 달아둔다.(결합카운트는 22장을 참고하라)  
### 변경 영향의 이해
앞으로 수행하려는 변경의 영향을 이해하고 싶을때는 영향 스케치를 작성하는 대신에 변경하려는 코드에 표시한다.  
그리고 변경으로 인해 값이 바뀔 가능성이 있는 변수와 영향을 받을 가능성이 있는 메소드 호출에 모두 표시한다. 그 다음에는 지금 막 표시한 곳으로 부터 다시 영향을 받는 변수와 메소드에 표시한다.  
필요에따라 반복함으로서 변경으로 인한 영향이 어떻게 전파되는지 이해한다. 이는 무엇을 테스트해야할지 이해하는데도 큰 도움이 된다.  

## 스크래치 리팩토링
코드를 배우는 최선의 기법 가운데 하나가 리팩토링이다.  
리팩토링의 유일한 문제점은 테스트 루틴이 준비되어있지 않으면 위험한 작업이 될 수 있다는 것이다.  
코드를 이ㅐ해하기 위해 다양한 리팩토링을 했을 때 무언가 잘못되지 않았는지 어떻게 확인할 수 있을까?  
먼저 버전 관리 시스템에서 코드를 체크아웃 한 후, 테스트 루틴 작성은 잊어버리자.  
메소드 추출이든 변수 이동이든 다양한 방법으로 리팩토링을 하자. 단 그 코드는 다시 체크인 하지 말고 그냥 버린다. 이를 스크래치 리팩토링 기법이라 한다.  
이 기법은 본질을 발견하고 코드의 동작을 이해할 수 있는 훌륭한 방법이지만 위험요소가 존재하는데
1. 리팩토링 중에 무언가 착각해서 시스템이 실제로는 하지 않는 일을 하고 있다고 잘못 믿어버리는 것
2. 리팩토링을 한 결과에 집착하게 돼 항상 그 결과에 맞춰서 생각하게 되는 것

이 두가지를 명심하며 사용한다면 코드의 중요한 부분을 이해하고 확신할 수 있는 좋은 방법이며 이후의 변경 작업을 수월하게 해줄 것이다.

## 미사용 코드 삭제
혼란스럽고 사용되지 않는 것으로 판단되는 코드는 삭제한다. 방해만 될 뿐 아무것도 하지 않는 코드이기 때문이다.  
삭제된 코드가 혹시 나중에 쓰이게 될 수도 있지만 신경쓰지말자. 이는 버전관리 시스템으로 불러오기만 하면 된다.
